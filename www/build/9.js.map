{"version":3,"sources":["../../src/app/pages/payments/payments.component.module.ts","../../src/app/pages/payments/payments.component.ts"],"names":[],"mappings":"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","file":"9.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\n\r\nimport { TranslateModule } from '@ngx-translate/core';\r\n\r\nimport { PaymentsPageComponent } from './payments.component';\r\nimport { ComponentsModule } from '../../components/components.module';\r\nimport { PaymentsService } from '../../providers';\r\n\r\n@NgModule({\r\n    declarations: [\r\n        PaymentsPageComponent,\r\n    ],\r\n    imports: [\r\n        IonicPageModule.forChild(PaymentsPageComponent),\r\n        TranslateModule,\r\n        ComponentsModule\r\n    ],\r\n    providers: [\r\n        PaymentsService\r\n    ]\r\n})\r\nexport class PaymentsPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/pages/payments/payments.component.module.ts","import { Component, OnInit } from '@angular/core';\r\nimport {\r\n    IonicPage,\r\n    Refresher,\r\n    PopoverController\r\n} from 'ionic-angular';\r\n\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport * as _ from 'lodash';\r\n\r\nimport { Payment, Player, PaymentsFilter, Month } from '../../models';\r\nimport { ContextService, MessagesService, PaymentsService } from '../../providers';\r\nimport { PaymentsFilterComponent } from '../../components/payments-filter/payments-filter.component';\r\n\r\n@IonicPage({\r\n    name: 'PaymentsPage',\r\n    segment: 'payments'\r\n})\r\n@Component({\r\n    selector: 'fwf-page-payments',\r\n    templateUrl: 'payments.component.html'\r\n})\r\nexport class PaymentsPageComponent implements OnInit {\r\n\r\n    payments: Payment[] = [];\r\n    playerLogged: Player;\r\n    filterIconClass: string;\r\n    selectedFilters: PaymentsFilter = {};\r\n\r\n    constructor(\r\n            private paymentService: PaymentsService,\r\n            private translate: TranslateService,\r\n            private popoverCtrl: PopoverController,\r\n            private context: ContextService,\r\n            private messages: MessagesService,\r\n    ) {\r\n        this.playerLogged = this.context.getPlayerLogged();\r\n     }\r\n\r\n    ionViewWillEnter() {\r\n        // It's necessary when comes here from back button'\r\n        this.loadListPayments();\r\n    }\r\n\r\n    ngOnInit() {\r\n        this.selectedFilters.showPaidPayments = false;\r\n        this.selectedFilters.showNoPaidPayments = true;\r\n\r\n    }\r\n\r\n    loadListPayments(refresher?: Refresher): void {\r\n        this.paymentService\r\n            .fetchPayments(this.playerLogged.id, this.selectedFilters)\r\n            .subscribe(\r\n                data => {\r\n                    let payments = data.map(payment => {\r\n                        let matchDate = payment.matchDate;\r\n                        let name = '';\r\n                        let monthIndex = 0;\r\n                        if (matchDate) {\r\n                            name = matchDate.split('T')[0];\r\n                        } else {\r\n                            name = `${this.translate.instant('MONTHS.' + payment.month)} - ${payment.year}`;\r\n                            monthIndex = Month.getIndex(payment.month);\r\n                        }\r\n                        return <Payment> {\r\n                            ...payment,\r\n                            name: name,\r\n                            monthIndex: monthIndex\r\n                        };\r\n                    });\r\n                    this.initializeList(payments);\r\n                },\r\n                err => {\r\n                    this.endAnimations(refresher);\r\n                    this.messages.showError(err);\r\n                },\r\n                () => this.endAnimations(refresher)\r\n            );\r\n    }\r\n\r\n    openFilter(clickEvent): void {\r\n        let popover = this.popoverCtrl.create(\r\n            PaymentsFilterComponent,\r\n            { cssClass: 'popover__filter' }\r\n        );\r\n        popover.onDidDismiss(selectedFilters => {\r\n            if (selectedFilters) {\r\n                this.selectedFilters = selectedFilters;\r\n                this.loadListPayments();\r\n                this.filterIconClass = this.getFilterIconClass(selectedFilters);\r\n            }\r\n        });\r\n        popover.present({\r\n            ev: clickEvent\r\n        });\r\n    }\r\n\r\n    private endAnimations(refresher: Refresher) {\r\n        if (refresher) {\r\n            refresher.complete();\r\n        }\r\n    }\r\n\r\n    private initializeList(data: Payment[]) {\r\n        this.payments = _.orderBy(data, ['year', 'monthIndex', 'matchDate'], ['desc', 'desc', 'desc']);\r\n    }\r\n\r\n    private getFilterIconClass(selectedFilters: PaymentsFilter): string {\r\n        let classIcon: string;\r\n        if (!selectedFilters.showNoPaidPayments || !selectedFilters.showPaidPayments || selectedFilters.year) {\r\n            classIcon = 'filter__in-use';\r\n        }\r\n        return classIcon;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/pages/payments/payments.component.ts"],"sourceRoot":""}