{"version":3,"sources":["../../src/app/pages/payments/payments.component.module.ts","../../src/app/pages/payments/payments.component.ts"],"names":[],"mappings":"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","file":"9.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\n\nimport { TranslateModule } from '@ngx-translate/core';\n\nimport { PaymentsPageComponent } from './payments.component';\nimport { ComponentsModule } from '../../components/components.module';\nimport { PaymentsService } from '../../providers';\n\n@NgModule({\n    declarations: [\n        PaymentsPageComponent,\n    ],\n    imports: [\n        IonicPageModule.forChild(PaymentsPageComponent),\n        TranslateModule,\n        ComponentsModule\n    ],\n    providers: [\n        PaymentsService\n    ]\n})\nexport class PaymentsPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/pages/payments/payments.component.module.ts","import { Component, OnInit } from '@angular/core';\nimport {\n    IonicPage,\n    Refresher,\n    PopoverController\n} from 'ionic-angular';\n\nimport { TranslateService } from '@ngx-translate/core';\nimport * as _ from 'lodash';\n\nimport { Payment, Player, PaymentsFilter, Month } from '../../models';\nimport { ContextService, MessagesService, PaymentsService } from '../../providers';\nimport { PaymentsFilterComponent } from '../../components/payments-filter/payments-filter.component';\n\n@IonicPage({\n    name: 'PaymentsPage',\n    segment: 'payments'\n})\n@Component({\n    selector: 'fwf-page-payments',\n    templateUrl: 'payments.component.html'\n})\nexport class PaymentsPageComponent implements OnInit {\n\n    payments: Payment[] = [];\n    playerLogged: Player;\n    filterIconClass: string;\n    selectedFilters: PaymentsFilter = {};\n\n    constructor(\n            private paymentService: PaymentsService,\n            private translate: TranslateService,\n            private popoverCtrl: PopoverController,\n            private context: ContextService,\n            private messages: MessagesService,\n    ) {\n        this.playerLogged = this.context.getPlayerLogged();\n     }\n\n    ionViewWillEnter() {\n        // It's necessary when comes here from back button'\n        this.loadListPayments();\n    }\n\n    ngOnInit() {\n        this.selectedFilters.showPaidPayments = false;\n        this.selectedFilters.showNoPaidPayments = true;\n\n    }\n\n    loadListPayments(refresher?: Refresher): void {\n        this.paymentService\n            .fetchPayments(this.playerLogged.id, this.selectedFilters)\n            .subscribe(\n                data => {\n                    let payments = data.map(payment => {\n                        let matchDate = payment.matchDate;\n                        let name = '';\n                        let monthIndex = 0;\n                        if (matchDate) {\n                            name = matchDate.split('T')[0];\n                        } else {\n                            name = `${this.translate.instant('MONTHS.' + payment.month)} - ${payment.year}`;\n                            monthIndex = Month.getIndex(payment.month);\n                        }\n                        return <Payment> {\n                            ...payment,\n                            name: name,\n                            monthIndex: monthIndex\n                        };\n                    });\n                    this.initializeList(payments);\n                },\n                err => {\n                    this.endAnimations(refresher);\n                    this.messages.showError(err);\n                },\n                () => this.endAnimations(refresher)\n            );\n    }\n\n    openFilter(clickEvent): void {\n        let popover = this.popoverCtrl.create(\n            PaymentsFilterComponent,\n            { cssClass: 'popover__filter' }\n        );\n        popover.onDidDismiss(selectedFilters => {\n            if (selectedFilters) {\n                this.selectedFilters = selectedFilters;\n                this.loadListPayments();\n                this.filterIconClass = this.getFilterIconClass(selectedFilters);\n            }\n        });\n        popover.present({\n            ev: clickEvent\n        });\n    }\n\n    private endAnimations(refresher: Refresher) {\n        if (refresher) {\n            refresher.complete();\n        }\n    }\n\n    private initializeList(data: Payment[]) {\n        this.payments = _.orderBy(data, ['year', 'monthIndex', 'matchDate'], ['desc', 'desc', 'desc']);\n    }\n\n    private getFilterIconClass(selectedFilters: PaymentsFilter): string {\n        let classIcon: string;\n        if (!selectedFilters.showNoPaidPayments || !selectedFilters.showPaidPayments || selectedFilters.year) {\n            classIcon = 'filter__in-use';\n        }\n        return classIcon;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/pages/payments/payments.component.ts"],"sourceRoot":""}